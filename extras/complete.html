<html lang=en><title>Wavefunction Simulator</title><link href=https://fonts.googleapis.com rel=preconnect><link href=https://fonts.gstatic.com rel=preconnect crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap"rel=stylesheet><link href=/img/icon.ico rel=icon type=image/x-icon><meta charset=UTF-8><meta content="IE=edge"http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1"name=viewport><meta content="Miles Waugh"name=author><body onload=setup()><div id=mainbox><div id=title><h1 class="reset-cursor header">Wavefunction Simulator</h1></div><div class="flex-container flex-column flex-center"><div class="flex-container flex-center flex-row"id=r1><div class="flex-container flex-column"><div class=flex id=BB-container><BB height=600 id=BB width=600></BB></div><div class=flex-child id=BB-xaxis><a href=https://github.com/piano-miles/Wavefunction-Simulator id=src>View the code on GitHub</a></div></div><div class=flex-child id=RR><div class="flex-container flex-column"id=QQ><div class="flex-child SS header"id=parameters><h2 class="reset-cursor NN"id=OO>Parameters</h2></div><hr><div class="flex-child SS"id=inputs><h3 class="reset-cursor NN">Inputs</h3><div class=iblock><label class=label id=Vlabel>V:</label><div class=tooltip><textarea class=input id=V name=V title=V type=text>x*x/2e2</textarea><div class=computation-tooltip id=potential><p class=link>This is the <a href=https://en.wikipedia.org/wiki/Potential_energy rel=noopener target=_blank>potential</a>.</div></div></div><div class=iblock><label class="reset-cursor label">Substeps:</label><div class=tooltip><span class=input contenteditable=""id=O role=textbox title=O>80</span><div class=states-tooltip id=substep-tip><p>The number of evolution gradations within a frame.<p>Normalization is performed every five steps.</div></div><p></div><pre id=subrec class=PP>(substep rec: )</pre><div class=center><button id=update>Update</button></div><div id=front><div class="reset-cursor iblock"id=checkdiv><input checked class=checkbox id=H onchange=resolve(this) title=H type=checkbox> <label class=label>Pause</label></div><button id=start onclick=resolve(this)><p>To begin, uncheck this 'pause' box. Click this message to hide it.<p id=info>You may hover over various parameters for more elaboration on what they mean.</button></div><div id=blurry></div></div><hr><div class="flex-child SS"id=outputs><div class=parameter-group><h3 class="reset-cursor NN">States</h3><div class=tooltip><pre id=t class=PP>t=0.000 zs</pre><div class=states-tooltip><p>The global time passed since initialization.<p>(zs=zeptoseconds)</div></div><div class=tooltip><pre id=xscl class=PP>width=4.634 pm</pre><div class=states-tooltip><p>The width of the viewport window.<p>(pm=picometers)</div></div></div><hr><div class=parameter-group><h3 class="reset-cursor NN">Computation Breakdown</h3><div class=tooltip><pre id=t1 class=PP>Evolution (ms): </pre><div class=computation-tooltip><p>Time spent evolving and normalizing the wavefunction.<p>(1-second average per frame, in milliseconds)</div></div><div class=tooltip><pre id=t2 class=PP>Render (ms): </pre><div class=computation-tooltip><p>Time spent rendering the components on the viewport.<p>(1-second average per frame, in milliseconds)</div></div><div class=tooltip><pre id=t3 class=PP>Other (ms): </pre><div class=computation-tooltip><p>Time spent doing other stuff. (Obviously)<p>(1-second average per frame, in milliseconds)</div></div></div><hr><div class=parameter-group><h3 class="reset-cursor NN">Other</h3><div class=tooltip><pre id=fps class=PP>FPS: </pre><div class=states-tooltip id=FPS><p>Frames rendered per second.</div></div></div></div></div></div></div><div class=flex-child><div class="flex-container flex-column center"id=console><h2 class=reset-cursor>Console</h2><hr><pre id=MM contenteditable="">To begin, please uncheck the "pause" box.</pre></div></div></div></div><script>var setup,draw,L;(function(){var _$0=this,_2=function(){let e=document.getElementById("BB"),t=document.getElementById("MM");if(L=function(){let e=arguments;if(3==e.length||4==e.length&&e[3]){let n=e[0],$=e[1],o=e[2];"red"==$?$="#ed2f2f":"green"==$?$="#c4ffad":"white"==$&&($="#ffffff"),t.style.color=$,"add"==o?t.innerHTML+=n:t.innerHTML=n}else if(e[3])throw"Incorrect number of arguments passed ("+e.length+")."},e.getContext)e.width=600,e.height=600,draw();else if(e.outerHTML)try{e.outerHTML="<h1>There was an issue with BB.</h1>"}finally{L("Uh oh. Looks like there's a problem with BB.","red","set")}},_3=function(){let BB=document.getElementById("BB"),FF=BB.getContext("2d"),width=600,height=600;FF.globalCompositeOperation="destination-over";let W=600,U=1,T=5,maths=["abs","acos","asin","atan","cbrt","ceil","cos","cosh","exp","floor","hypot","log","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc"],t1=document.getElementById("t1"),t2=document.getElementById("t2"),t3=document.getElementById("t3"),F=document.getElementById("V"),D=document.getElementById("t"),J=document.getElementById("fps"),K=document.getElementById("O"),E=document.getElementById("subrec"),H=document.getElementById("H"),G=document.getElementById("xscl"),fps=0,O=80,KK=0,dt=.001,dtsc=dt/O,dtsch=.5*dtsc,dtscs=dtsc/6,dx=.02,dx2=1/(dx*dx),init=!0,V=[],P="",Q=Array(600).fill([0,0]),wf2=Array(600).fill(0),HH=0,II=0,JJ=0,EE=0,DD=0,times=[],S=Array.from(Array(600),(e,t)=>t),CC=Array.from(Array(598),(e,t)=>t+1);function A(){V=[];for(let x=-300;x<300;x++)V.push(eval(P))}let B=(e,t)=>[Math.cos(e)*t,Math.sin(e)*t];function X(e,t){FF.lineWidth=2,FF.strokeStyle="#cc5050d0",FF.beginPath(),FF.moveTo(0,300-V[0]*T);for(let n=1;n<600;n++)FF.lineTo(n,300-V[n]*T);FF.stroke(),FF.fillStyle="#ffffff20",FF.strokeStyle="#ccccccd0",N=300/Math.max.apply(null,t),FF.beginPath(),FF.moveTo(0,300);for(let $=0;$<t.length;$++){let o=300-t[$]*N;FF.lineTo($,o)}FF.lineTo(600,300),FF.stroke(),FF.closePath(),FF.fill(),FF.strokeStyle="#f79368d0",FF.beginPath(),FF.moveTo(0,300-e[0][0]*W);for(let i=1;i<e.length;i++){let s=300-e[i][0]*W;FF.lineTo(i,s)}FF.stroke(),FF.strokeStyle="#68b7f7d0",FF.beginPath(),FF.moveTo(0,300-e[0][1]*W);for(let r=1;r<e.length;r++){let a=300-e[r][1]*W;FF.lineTo(r,a)}FF.stroke()}let sqa=e=>e.map(e=>e[0]*e[0]+e[1]*e[1]);function C(e,t){if(LL=0,t.forEach(e=>LL+=e),LL<=0)throw"There is an issue with your wavefunction.";return LL=Math.sqrt(LL),e.map(e=>e.map(e=>e/LL))}function Z(){console.log("updating inputs");let R=F.value.trim();maths.forEach(e=>R.replace(e,"Math."+e)),AA=!1;try{for(let x=0;x<600;x++){let y=eval(R)+0}P=R,A(),L("Successfully updated V to "+P+"\n","green","set");let M=K.innerHTML.trim();try{(M=Math.floor(M)+0)>0&&M<1/0?(O=M,L("Successfully updated O to "+O,"green","add"),AA=!0):L("ERROR:\nUpdating O:\nInvalid value.\nPlease make sure it is a positive non-zero int.","red","add")}catch(t){L("ERROR:\nUpdating O:\n"+t,"red","add")}}catch(t){L("ERROR:\nUpdating potential:\n"+t,"red","set")}AA&&(FF.clearRect(0,0,BB.width,BB.height),X(Q,wf2),dtsch=.5*(dtsc=dt/O),dtscs=dtsc/6,dx2=1/(dx*dx),G.innerHTML="width = "+(dx*width*.3862).toFixed(3)+" pm")}function I(){for(let e=0;e<600;e++){let t=.01*(e-300),n=B(7*t,Math.exp(-t*t*100));Q[e]=n;let $=n[0]*n[0]+n[1]*n[1];wf2[e]=$}wf2=sqa(Q),wf2=sqa(Q=C(Q,wf2)),Z(!1),L('To begin, please uncheck the "pause" box.',"white","set")}let Y=e=>{let t=CC.map(t=>[(e[t-1][0]+e[t+1][0]-2*e[t][0])*dx2,(e[t-1][1]+e[t+1][1]-2*e[t][1])*dx2]);return t.unshift(t[0]),t.push(t[t.length-1]),t};function GG(e){let t=(l=Y(e)).map(e=>[-.5*e[1],.5*e[0]]);return S.map(n=>[e[n][1]*V[n]+t[n][0],-e[n][0]*V[n]+t[n][1]])}function evolve(e){let t=GG(e),n=GG(S.map(n=>[e[n][0]+t[n][0]*dtsch,e[n][1]+t[n][1]*dtsch])),$=GG(S.map(t=>[e[t][0]+n[t][0]*dtsch,e[t][1]+n[t][1]*dtsch])),o=GG(S.map(t=>[e[t][0]+$[t][0]*dtsc,e[t][1]+$[t][1]*dtsc])),i=S.map(i=>[e[i][0]+(t[i][0]+2*n[i][0]+2*$[i][0]+o[i][0])*dtscs,e[i][1]+(t[i][1]+2*n[i][1]+2*$[i][1]+o[i][1])*dtscs]);return i[0]=[0,0],i[i.length-1]=[0,0],i}function update(){if(!H.checked){let e=times[times.length-1];(times=[]).push(e),FF.clearRect(0,0,BB.width,BB.height),times.push(performance.now());for(let t=0;t<O;t++)Q=evolve(Q),t%5==0&&(wf2=sqa(Q),Q=C(Q,wf2));if(times.push(performance.now()),X(Q,wf2),times.push(performance.now()),JJ+=times[1]-times[0],HH+=times[2]-times[1],II+=times[3]-times[2],DD+=times[3]-times[1],EE%60==0){let n=HH+II+JJ;t1.innerHTML=`Evolution (ms): ${(HH/60).toFixed(2)} (${~~(100*HH/n)}%)`,t2.innerHTML=`Render    (ms): ${(II/60).toFixed(2)} (${~~(100*II/n)}%)`,t3.innerHTML=`Other     (ms): ${(JJ/60).toFixed(2)} (${~~(100*JJ/n)}%)`,fps=6e4/DD,J.innerHTML="FPS: "+fps.toFixed(1),subrec=10*~~(O*fps/400),E.innerHTML="(substep rec: "+subrec+")",HH=0,II=0,JJ=0,DD=0}KK+=dt,D.innerHTML="t     = "+(1.288*KK).toPrecision(4)+" zs",++EE>=240&&(EE=0)}requestAnimationFrame(update)}document.getElementById("update").addEventListener("click",e=>{Z()}),I(),init=!1,update()};_$0.setup=_2,_$0.draw=_3}).call(this);</script><script>resolve=e=>e.checked||(document.getElementById("start").remove(),document.getElementById("blurry").remove())</script>

